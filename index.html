<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Irregular Verb Challenge (‡∏Å‡∏£‡∏¥‡∏¢‡∏≤ 3 ‡∏ä‡πà‡∏≠‡∏á)</title>
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        /* Global & Default (Level 1-10) Theme */
        :root {
            --color-primary: #E64C3C; /* Vibrant Red/Primary - (‡πÇ‡∏à‡∏ó‡∏¢‡πå V1/V2, ‡πÄ‡∏Ç‡πâ‡∏°‡∏Ç‡∏∂‡πâ‡∏ô‡πÅ‡∏•‡∏∞‡∏™‡∏î‡∏Ç‡∏∂‡πâ‡∏ô) */
            --color-secondary: #FBCEB1; /* Peach (‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á Prompt, ‡∏õ‡∏∏‡πà‡∏°‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏Å‡∏ï‡∏¥) */
            --color-correct: #27AE60; /* Emerald Green - (‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏ñ‡∏π‡∏Å, ‡πÄ‡∏Ç‡πâ‡∏°‡∏Ç‡∏∂‡πâ‡∏ô‡πÅ‡∏•‡∏∞‡∏™‡∏î‡∏Ç‡∏∂‡πâ‡∏ô) */
            --color-wrong: #43B3AE; /* ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß‡πÄ‡∏ó‡∏≠‡∏£‡πå‡∏Ñ‡∏ß‡∏≠‡∏¢‡∏ã‡πå (‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏ú‡∏¥‡∏î/‡∏õ‡∏∏‡πà‡∏° Auto) */
            --color-bg: #F7F9FC; /* ‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏≠‡πà‡∏≠‡∏ô */
            --color-card: #FFFFFF;
            --color-text-dark: #333333; /* ‡πÄ‡∏Ç‡πâ‡∏°‡∏Ç‡∏∂‡πâ‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏ï‡∏±‡∏î‡∏Å‡∏±‡∏ö‡∏™‡∏µ‡∏≠‡πà‡∏≠‡∏ô */
            --color-text-light: #FFFFFF;
        }
        
        /* Hard/Expert Theme (Level 11-20) - Adjusted to be darker but still in a pleasing tone */
        .container.hard-theme {
            background-color: #E64C3C; /* Primary color for hard theme background */
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            color: var(--color-text-dark); 
        }
        .container.hard-theme header {
            background-color: #C0392B; /* Darker primary for header (Updated) */
            color: var(--color-text-light); 
        }
        .container.hard-theme header h1 { color: var(--color-text-light); }

        /* Hard Theme Mode Selection Buttons */
        .container.hard-theme .mode-btn {
            background-color: #43B3AE; /* Turquoise for modes */
            box-shadow: 0 5px 0 #328783;
            color: var(--color-text-light);
        }
        .container.hard-theme .mode-btn:nth-child(2) {
            background-color: #FBCEB1; /* Peach for auto mode */
            box-shadow: 0 5px 0 #E3B290;
            color: var(--color-text-dark); 
        }
        .container.hard-theme .mode-btn:active {
            transform: translateY(2px);
            box-shadow: 0 2px 0;
        }

        /* Hard Theme Game Screen Styles */
        .container.hard-theme #prompt-area {
            background-color: var(--color-bg); 
            border: 3px solid var(--color-primary); 
            color: var(--color-text-dark);
        }
        .container.hard-theme #thai-prompt { 
            color: var(--color-primary); 
        } 
        .container.hard-theme #timer-bar-container { background-color: #E0E0E0; } /* Lighter gray */
        .container.hard-theme #timer-bar { background-color: #27AE60; } /* Emerald green timer bar (Updated) */
        .container.hard-theme .choice-button {
            background-color: #43B3AE; /* Turquoise choice buttons */
            box-shadow: 0 5px 0 #328783;
            color: var(--color-text-light);
        }
        .container.hard-theme #next-btn {
            background-color: #FBCEB1; /* Peach next button */
            box-shadow: 0 4px 0 #E3B290;
            color: var(--color-text-dark);
        }
        
        .container.hard-theme #auto-toggle-btn {
            background-color: #27AE60; /* Emerald Green for START Auto (Updated) */
            box-shadow: 0 4px 0 #1A8644; /* Darker green shadow (Updated) */
            color: var(--color-text-dark);
        }
        .container.hard-theme #auto-toggle-btn.auto-active {
            background-color: #E64C3C; /* Primary Red for STOP Auto (Updated) */
            box-shadow: 0 4px 0 #C0392B; /* Darker primary shadow (Updated) */
            color: var(--color-text-light);
        }
        /* --- END HARD THEME --- */


        body {
            font-family: 'Sarabun', sans-serif;
            background-color: var(--color-bg);
            color: var(--color-text-dark);
            margin: 0;
            padding: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            text-align: center;
        }

        .container {
            width: 100%;
            max-width: 500px;
            box-sizing: border-box;
            background-color: var(--color-card);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.08);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
            padding: 0;
            transition: all 0.5s ease;
        }

        /* Header */
        header {
            background-color: var(--color-primary);
            color: var(--color-text-light);
            padding: 1.5rem 1rem;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
            margin-bottom: 1rem;
            transition: background-color 0.5s;
        }
        header h1 {
            font-size: 1.8rem;
            margin: 0;
            color: var(--color-text-light);
        }
        header p {
            font-size: 0.9rem;
            margin: 0.2rem 0 0 0;
            font-weight: 300;
            display: none; 
        }

        /* Screen Management */
        .screen {
            padding: 1rem;
            display: none; 
            flex-grow: 1;
            flex-direction: column;
            justify-content: space-between;
        }
        .screen.active {
            display: flex;
        }

        /* --- Level Selection Screen --- */
        #level-select-screen .level-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            padding: 1rem 0;
        }
        .level-btn {
            background-color: var(--color-correct); 
            color: var(--color-text-dark);
            border: none;
            padding: 1.5rem 0.5rem;
            border-radius: 12px;
            font-size: 1.4rem;
            font-weight: bold;
            cursor: pointer;
            box-shadow: 0 4px 0 #1A8644; /* Darker green shadow (Updated) */
            transition: transform 0.1s, box-shadow 0.1s, background-color 0.2s;
        }
        .level-btn.level-btn-11-20 {
            background-color: var(--color-primary); /* Use primary color for hard levels */
            color: var(--color-text-light);
            box-shadow: 0 4px 0 #C0392B; /* Darker primary shadow (Updated) */
        }
        .level-btn:active {
            transform: translateY(2px);
            box-shadow: 0 2px 0 #1A8644; /* Darker green shadow (Updated) */
        }
        .level-btn.level-btn-11-20:active {
            box-shadow: 0 2px 0 #C0392B; /* Darker primary shadow (Updated) */
        }
        .level-btn-title {
            font-size: 0.8rem;
            font-weight: 400;
            display: block;
            margin-top: 5px;
        }
        
        /* --- Mode Selection Screen --- */
        #mode-select-screen {
            justify-content: center;
            align-items: center;
            gap: 20px;
        }
        #mode-select-screen .mode-btn-group {
            display: flex;
            flex-direction: column;
            gap: 15px;
            width: 80%;
        }
        .mode-btn {
            background-color: var(--color-correct);
            color: var(--color-text-dark);
            border: none;
            padding: 1.5rem;
            border-radius: 15px;
            font-size: 1.5rem;
            font-weight: bold;
            cursor: pointer;
            box-shadow: 0 5px 0 #1A8644; /* Darker green shadow (Updated) */
            transition: transform 0.1s, box-shadow 0.1s;
        }
        .mode-btn:nth-child(2) {
            background-color: var(--color-wrong); /* Turquoise for Auto */
            box-shadow: 0 5px 0 #328783; /* Darker turquoise shadow */
            color: var(--color-text-light); /* Text color for turquoise button */
        }
        .mode-btn:active {
            transform: translateY(3px);
            box-shadow: 0 2px 0 #1A8644; /* Darker green shadow (Updated) */
        }
        #back-to-level-btn {
            background-color: #B0BEC5 !important; 
            box-shadow: 0 5px 0 #90A4AE !important; 
            color: var(--color-text-dark) !important;
        }
        
        /* --- Game Screen --- */
        #game-screen .status-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.5rem 0;
            font-weight: bold;
            margin-bottom: 1.5rem;
        }
        /* Step Indicator */
        #step-indicator {
            font-size: 1rem;
            color: #757575; /* Gray */
            font-weight: bold;
            margin-top: -1rem;
            margin-bottom: 0.5rem;
        }


        #prompt-area {
            background-color: var(--color-secondary); /* Use secondary for prompt background */
            border: 3px solid var(--color-primary);
            border-radius: 20px;
            padding: 2rem 1rem;
            min-height: 100px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            margin-bottom: 1.5rem;
            transition: all 0.5s ease;
        }
        #thai-prompt {
            font-size: 2.5rem;
            font-weight: 900;
            color: var(--color-primary);
            line-height: 1.3;
        }
        
        /* Timer Bar */
        #timer-bar-container {
            width: 100%;
            height: 10px;
            background-color: #ECEFF1;
            border-radius: 5px;
            margin-bottom: 1rem;
            overflow: hidden;
        }
        #timer-bar {
            width: 100%;
            height: 100%;
            background-color: var(--color-primary); /* Primary color for timer */
            transition: width 5s linear; 
        }

        /* Choice Buttons */
        #choices {
            display: flex;
            flex-direction: column;
            gap: 12px;
            flex-grow: 1; 
            justify-content: center; 
        }
        .choice-button {
            background-color: var(--color-secondary); 
            color: var(--color-text-dark); /* Dark text on light button */
            border: none;
            padding: 1.5rem;
            border-radius: 15px; 
            font-size: 1.6rem;
            font-weight: bold;
            cursor: pointer;
            box-shadow: 0 5px 0 #E3B290; /* Darker secondary shadow */
            transition: all 0.2s ease-in-out, font-size 0.3s, transform 0.3s;
        }
        /* State for a correctly answered choice button (V2 or V3) */
        .choice-button.correct {
            background-color: var(--color-correct);
            box-shadow: 0 5px 0 #1A8644; /* Darker green shadow (Updated) */
            color: var(--color-text-dark); 
            font-size: 2.5rem; /* Larger font for correct answer */
            transform: scale(1.05); /* Slightly bigger */
        }
        /* State for an incorrectly answered choice button */
        .choice-button.wrong {
            background-color: var(--color-wrong);
            box-shadow: 0 5px 0 #328783; 
            color: var(--color-text-light); 
        }
        /* State for choices that are not the focus (e.g., incorrect V2/V3 options when correct is highlighted) */
        .choice-button.dimmed {
            opacity: 0.5;
            transform: scale(0.95);
            font-size: 1.6rem; /* Back to normal size */
            box-shadow: none;
        }
        
        /* Footer/Control */
        #game-footer {
            display: flex;
            justify-content: space-between;
            gap: 10px; 
            margin-top: 2rem;
            padding-top: 1rem;
            border-top: 1px solid #ECEFF1;
        }

        #game-footer button {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            height: 60px; 
            padding: 0.5rem 0.5rem; 
            border: none;
            border-radius: 50px;
            font-size: 1.2rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.1s;
        }
        
        #next-btn {
            background-color: var(--color-primary);
            color: var(--color-text-light);
            box-shadow: 0 4px 0 #C0392B; /* Darker primary shadow (Updated) */
        }
        #next-btn:active {
            transform: translateY(2px);
            box-shadow: 0 2px 0 #C0392B; /* Darker primary shadow (Updated) */
        }
        
        /* Auto Toggle Button */
        #auto-toggle-btn {
            background-color: var(--color-correct); 
            color: var(--color-text-dark); 
            box-shadow: 0 4px 0 #1A8644; /* Darker green shadow (Updated) */
            width: 40%; 
        }
        #auto-toggle-btn.auto-active {
            background-color: var(--color-primary); /* Primary red for STOP Auto */
            box-shadow: 0 4px 0 #C0392B; /* Darker primary shadow (Updated) */
            color: var(--color-text-light); 
        }
        #auto-toggle-btn:active {
            transform: translateY(2px);
            box-shadow: 0 2px 0;
        }

        #auto-toggle-btn span {
            display: block; 
            font-size: 0.8em;
            font-weight: 400;
            line-height: 1;
        }

        /* Adjust button widths when auto-toggle is visible */
        #game-footer #next-btn {
             width: 100%; 
        }
        #game-footer.auto-mode #next-btn {
            width: 60%;
        }
        
    </style>
</head>
<body>

    <div class="container" id="main-container">
        <header>
            <h1>Irregular Verb Challenge (‡∏Å‡∏£‡∏¥‡∏¢‡∏≤ 3 ‡∏ä‡πà‡∏≠‡∏á)</h1>
            <p></p> 
        </header>

        <div id="level-select-screen" class="screen active">
            <h2>üèÜ ‡∏ä‡∏∏‡∏î‡∏Ñ‡∏≥‡∏®‡∏±‡∏û‡∏ó‡πå</h2>
            <p>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ä‡∏∏‡∏î‡∏Ñ‡∏≥‡∏®‡∏±‡∏û‡∏ó‡πå‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏ù‡∏∂‡∏Å‡∏ù‡∏ô:</p>
            <div class="level-grid" id="level-grid">
                </div>
            <p style="padding-top: 2rem; color:#9E9E9E;">‡∏Ñ‡∏•‡∏¥‡∏Å‡∏ó‡∏µ‡πà‡∏ä‡∏∏‡∏î‡∏Ñ‡∏≥‡∏®‡∏±‡∏û‡∏ó‡πå‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÇ‡∏´‡∏°‡∏î</p>
        </div>
        
        <div id="mode-select-screen" class="screen">
            <h2 id="mode-level-title">‡∏ä‡∏∏‡∏î X</h2>
            <p>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÇ‡∏´‡∏°‡∏î‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡πà‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ä‡∏∏‡∏î‡∏Ñ‡∏≥‡∏®‡∏±‡∏û‡∏ó‡πå‡∏ô‡∏µ‡πâ:</p>
            <div class="mode-btn-group">
                <button id="start-normal-btn" class="mode-btn">
                    ‚ñ∂Ô∏è ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏Å‡∏° (‡πÇ‡∏´‡∏°‡∏î‡∏õ‡∏Å‡∏ï‡∏¥)
                    <span style="display:block; font-size: 0.8em; font-weight: 400;">‡∏ï‡∏≠‡∏ö‡πÄ‡∏≠‡∏á, ‡πÄ‡∏ß‡∏•‡∏≤ 5 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ</span>
                </button>
                <button id="start-auto-btn" class="mode-btn">
                    ü§ñ ‡πÄ‡∏•‡πà‡∏ô‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥ (Auto Mode)
                    <span style="display:block; font-size: 0.8em; font-weight: 400;">‡πÄ‡∏â‡∏•‡∏¢‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥, ‡πÄ‡∏ß‡∏•‡∏≤ 3 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ</span>
                </button>
            </div>
            <button id="back-to-level-btn" class="mode-btn" style="width: 80%;">
                üîô ‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ä‡∏∏‡∏î‡∏Ñ‡∏≥‡∏®‡∏±‡∏û‡∏ó‡πå
            </button>
        </div>


        <div id="game-screen" class="screen">
            <div class="top-content">
                <div class="status-bar">
                    <span id="level-title">‡∏ä‡∏∏‡∏î: </span>
                    <span id="q-count">‡∏Ç‡πâ‡∏≠: 0/10</span>
                    <span id="score">‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô: 0</span>
                </div>

                <div id="timer-bar-container">
                    <div id="timer-bar"></div>
                </div>

                <p id="step-indicator">‡πÇ‡∏à‡∏ó‡∏¢‡πå V1 | ‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö V2</p>

                <div id="prompt-area">
                    <span id="thai-prompt">‡πÇ‡∏à‡∏ó‡∏¢‡πå V1 / ‡∏Ñ‡∏≥‡πÅ‡∏õ‡∏• / ‡πÄ‡∏â‡∏•‡∏¢‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</span>
                </div>

                <div id="choices">
                    <button id="choice-A" class="choice-button" disabled></button>
                    <button id="choice-B" class="choice-button" disabled></button>
                </div>
            </div>

            <div id="game-footer">
                <button id="auto-toggle-btn">
                    ‚ñ∂Ô∏è ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏•‡πà‡∏ô
                    <span>(Auto)</span>
                </button>
                <button id="next-btn" disabled>‡∏Ç‡πâ‡∏≠‡∏ñ‡∏±‡∏î‡πÑ‡∏õ ‚è≠Ô∏è/‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å</button>
            </div>
        </div>
    </div>

    <script>
        // --- DATA (20 Sets x 10 Questions = 200 verbs) ---
        // **Data Filtering for V1 != V2 or V2 != V3 has been performed.**
        const allQuizData = [
            { id: 1, title: "‡∏ä‡∏∏‡∏î A-C ‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô", questions: [
                { thai: "‡πÄ‡∏õ‡πá‡∏ô/‡∏≠‡∏¢‡∏π‡πà/‡∏Ñ‡∏∑‡∏≠", v1: "be", v2: "was/were", v3: "been", decoy: "become" },
                { thai: "‡πÄ‡∏£‡∏¥‡πà‡∏°", v1: "begin", v2: "began", v3: "begun", decoy: "come" },
                { thai: "‡∏ã‡∏∑‡πâ‡∏≠", v1: "buy", v2: "bought", v3: "bought", decoy: "catch" },
                { thai: "‡∏°‡∏≤", v1: "come", v2: "came", v3: "come", decoy: "do" },
                { thai: "‡∏à‡∏±‡∏ö", v1: "catch", v2: "caught", v3: "caught", decoy: "choose" },
                { thai: "‡∏ó‡∏≥", v1: "do", v2: "did", v3: "done", decoy: "drink" },
                { thai: "‡∏Ç‡∏±‡∏ö", v1: "drive", v2: "drove", v3: "driven", decoy: "eat" },
                { thai: "‡∏î‡∏∑‡πà‡∏°", v1: "drink", v2: "drank", v3: "drunk", decoy: "fall" },
                { thai: "‡∏Å‡∏¥‡∏ô", v1: "eat", v2: "ate", v3: "eaten", decoy: "feel" },
                { thai: "‡∏ö‡∏¥‡∏ô", v1: "fly", v2: "flew", v3: "flown", decoy: "find" },
            ]},
            { id: 2, title: "‡∏ä‡∏∏‡∏î F-H", questions: [
                { thai: "‡πÉ‡∏´‡πâ", v1: "give", v2: "gave", v3: "given", decoy: "go" },
                { thai: "‡πÑ‡∏õ", v1: "go", v2: "went", v3: "gone", decoy: "have" },
                { thai: "‡πÑ‡∏î‡πâ‡∏¢‡∏¥‡∏ô", v1: "hear", v2: "heard", v3: "heard", decoy: "hold" },
                { thai: "‡πÄ‡∏Å‡πá‡∏ö/‡∏£‡∏±‡∏Å‡∏©‡∏≤", v1: "keep", v2: "kept", v3: "kept", decoy: "know" },
                { thai: "‡∏£‡∏π‡πâ", v1: "know", v2: "knew", v3: "known", decoy: "leave" },
                { thai: "‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ", v1: "learn", v2: "learned/learnt", v3: "learned/learnt", decoy: "lose" },
                { thai: "‡∏ó‡∏≥/‡∏™‡∏£‡πâ‡∏≤‡∏á", v1: "make", v2: "made", v3: "made", decoy: "meet" },
                { thai: "‡∏û‡∏ö", v1: "meet", v2: "met", v3: "met", decoy: "pay" },
                { thai: "‡∏à‡πà‡∏≤‡∏¢", v1: "pay", v2: "paid", v3: "paid", decoy: "put" },
                { thai: "‡∏ß‡∏¥‡πà‡∏á", v1: "run", v2: "ran", v3: "run", decoy: "say" },
            ]},
            { id: 3, title: "‡∏ä‡∏∏‡∏î R-W ‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô", questions: [
                { thai: "‡∏≠‡πà‡∏≤‡∏ô", v1: "read", v2: "read", v3: "read", decoy: "run" },
                { thai: "‡∏û‡∏π‡∏î/‡∏Å‡∏•‡πà‡∏≤‡∏ß", v1: "say", v2: "said", v3: "said", decoy: "see" },
                { thai: "‡πÄ‡∏´‡πá‡∏ô", v1: "see", v2: "saw", v3: "seen", decoy: "send" },
                { thai: "‡∏™‡πà‡∏á", v1: "send", v2: "sent", v3: "sent", decoy: "sing" },
                { thai: "‡∏ô‡∏±‡πà‡∏á", v1: "sit", v2: "sat", v3: "sat", decoy: "sleep" },
                { thai: "‡∏ô‡∏≠‡∏ô", v1: "sleep", v2: "slept", v3: "slept", decoy: "speak" },
                { thai: "‡∏û‡∏π‡∏î", v1: "speak", v2: "spoke", v3: "spoken", decoy: "stand" },
                { thai: "‡∏¢‡∏∑‡∏ô", v1: "stand", v2: "stood", v3: "stood", decoy: "swim" },
                { thai: "‡πÄ‡∏≠‡∏≤/‡∏û‡∏≤‡πÑ‡∏õ", v1: "take", v2: "took", v3: "taken", decoy: "teach" },
                { thai: "‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô", v1: "write", v2: "wrote", v3: "written", decoy: "win" },
            ]},
            { id: 4, title: "‡∏Ñ‡∏≥‡∏Å‡∏£‡∏¥‡∏¢‡∏≤‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î", questions: [
                { thai: "‡∏´‡∏±‡∏Å/‡∏ó‡∏≥‡∏•‡∏≤‡∏¢", v1: "break", v2: "broke", v3: "broken", decoy: "bring" },
                { thai: "‡∏ô‡∏≥‡∏°‡∏≤", v1: "bring", v2: "brought", v3: "brought", decoy: "build" },
                { thai: "‡∏™‡∏£‡πâ‡∏≤‡∏á", v1: "build", v2: "built", v3: "built", decoy: "choose" },
                { thai: "‡πÄ‡∏•‡∏∑‡∏≠‡∏Å", v1: "choose", v2: "chose", v3: "chosen", decoy: "draw" },
                { thai: "‡∏ß‡∏≤‡∏î", v1: "draw", v2: "drew", v3: "drawn", decoy: "find" },
                { thai: "‡∏•‡∏∑‡∏°", v1: "forget", v2: "forgot", v3: "forgotten", decoy: "get" },
                { thai: "‡πÑ‡∏î‡πâ", v1: "get", v2: "got", v3: "got/gotten", decoy: "grow" },
                { thai: "‡πÇ‡∏ï/‡∏õ‡∏•‡∏π‡∏Å", v1: "grow", v2: "grew", v3: "grown", decoy: "lie" },
                { thai: "‡∏Ç‡∏µ‡πà", v1: "ride", v2: "rode", v3: "ridden", decoy: "ring" },
                { thai: "‡πÄ‡∏´‡πá‡∏ô/‡πÅ‡∏™‡∏î‡∏á", v1: "show", v2: "showed", v3: "shown/showed", decoy: "sing" },
            ]},
            // Set 5 (V1=V2=V3: cut, cost, hit, hurt, let, put, shut, spread, quit, set) **REMOVED**
            { id: 6, title: "‡∏ä‡∏∏‡∏î V2/V3 ‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡∏Å‡∏±‡∏ô 1", questions: [
                { thai: "‡∏ù‡∏±‡∏ô", v1: "dream", v2: "dreamed/dreamt", v3: "dreamed/dreamt", decoy: "feel" },
                { thai: "‡∏£‡∏π‡πâ‡∏™‡∏∂‡∏Å", v1: "feel", v2: "felt", v3: "felt", decoy: "fight" },
                { thai: "‡∏ï‡πà‡∏≠‡∏™‡∏π‡πâ", v1: "fight", v2: "fought", v3: "fought", decoy: "find" },
                { thai: "‡∏û‡∏ö", v1: "find", v2: "found", v3: "found", decoy: "get" },
                { thai: "‡πÅ‡∏Ç‡∏ß‡∏ô", v1: "hang", v2: "hung", v3: "hung", decoy: "have" },
                { thai: "‡∏ó‡∏≥/‡∏™‡∏£‡πâ‡∏≤‡∏á", v1: "make", v2: "made", v3: "made", decoy: "mean" },
                { thai: "‡∏´‡∏°‡∏≤‡∏¢‡∏ñ‡∏∂‡∏á", v1: "mean", v2: "meant", v3: "meant", decoy: "sell" },
                { thai: "‡∏Ç‡∏≤‡∏¢", v1: "sell", v2: "sold", v3: "sold", decoy: "send" },
                { thai: "‡∏¢‡∏¥‡∏á", v1: "shoot", v2: "shot", v3: "shot", decoy: "sleep" },
                { thai: "‡∏™‡∏≠‡∏ô", v1: "teach", v2: "taught", v3: "taught", decoy: "think" },
            ]},
            { id: 7, title: "‡∏ä‡∏∏‡∏î V2/V3 ‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡∏Å‡∏±‡∏ô 2", questions: [
                { thai: "‡∏ö‡∏≠‡∏Å", v1: "tell", v2: "told", v3: "told", decoy: "think" },
                { thai: "‡∏Ñ‡∏¥‡∏î", v1: "think", v2: "thought", v3: "thought", decoy: "understand" },
                { thai: "‡∏ä‡∏ô‡∏∞", v1: "win", v2: "won", v3: "won", decoy: "write" },
                { thai: "‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à", v1: "understand", v2: "understood", v3: "understood", decoy: "wear" },
                { thai: "‡∏™‡∏ß‡∏°‡πÉ‡∏™‡πà", v1: "wear", v2: "wore", v3: "worn", decoy: "lend" },
                { thai: "‡πÅ‡∏û‡πâ/‡∏´‡∏≤‡∏¢", v1: "lose", v2: "lost", v3: "lost", decoy: "light" },
                { thai: "‡∏à‡∏∏‡∏î‡πÑ‡∏ü/‡∏™‡πà‡∏≠‡∏á", v1: "light", v2: "lit/lighted", v3: "lit/lighted", decoy: "sit" },
                { thai: "‡∏Ç‡∏∏‡∏î", v1: "dig", v2: "dug", v3: "dug", decoy: "stand" },
                { thai: "‡∏ï‡∏¥‡∏î/‡∏¢‡∏∂‡∏î", v1: "stick", v2: "stuck", v3: "stuck", decoy: "strike" },
                { thai: "‡∏Ñ‡∏∑‡∏ö‡∏Ñ‡∏•‡∏≤‡∏ô", v1: "creep", v2: "crept", v3: "crept", decoy: "keep" },
            ]},
            { id: 8, title: "‡∏Ñ‡∏≥‡∏Å‡∏£‡∏¥‡∏¢‡∏≤‡∏ó‡∏µ‡πà‡∏Ñ‡∏•‡πâ‡∏≤‡∏¢‡∏Å‡∏±‡∏ô", questions: [
                { thai: "‡∏Å‡∏•‡∏≤‡∏¢‡πÄ‡∏õ‡πá‡∏ô", v1: "become", v2: "became", v3: "become", decoy: "begin" },
                { thai: "‡∏ß‡∏¥‡πà‡∏á", v1: "run", v2: "ran", v3: "run", decoy: "ring" },
                { thai: "‡∏ß‡πà‡∏≤‡∏¢‡∏ô‡πâ‡∏≥", v1: "swim", v2: "swam", v3: "swum", decoy: "drink" },
                { thai: "‡∏¢‡∏Å/‡∏•‡∏∏‡∏Å‡∏Ç‡∏∂‡πâ‡∏ô", v1: "rise", v2: "rose", v3: "risen", decoy: "raise" },
                { thai: "‡πÄ‡∏õ‡πà‡∏≤", v1: "blow", v2: "blew", v3: "blown", decoy: "break" },
                { thai: "‡∏ß‡∏≤‡∏î/‡∏î‡∏∂‡∏á", v1: "draw", v2: "drew", v3: "drawn", decoy: "drive" },
                { thai: "‡∏ã‡πà‡∏≠‡∏ô", v1: "hide", v2: "hid", v3: "hidden", decoy: "hold" },
                { thai: "‡∏™‡∏±‡πà‡∏ô", v1: "shake", v2: "shook", v3: "shaken", decoy: "take" },
                { thai: "‡πÄ‡∏´‡πá‡∏ô", v1: "see", v2: "saw", v3: "seen", decoy: "say" },
                { thai: "‡∏û‡∏±‡∏î/‡πÄ‡∏õ‡πà‡∏≤", v1: "wind", v2: "wound", v3: "wound", decoy: "wring" },
            ]},
            { id: 9, title: "‡∏Å‡∏£‡∏¥‡∏¢‡∏≤‡∏¢‡∏≤‡∏Å 1", questions: [
                { thai: "‡∏ó‡∏≥‡∏ú‡∏¥‡∏î", v1: "mistake", v2: "mistook", v3: "mistaken", decoy: "misunderstand" },
                { thai: "‡πÉ‡∏´‡πâ‡∏≠‡∏†‡∏±‡∏¢", v1: "forgive", v2: "forgave", v3: "forgiven", decoy: "forget" },
                { thai: "‡∏•‡∏∞‡∏ó‡∏¥‡πâ‡∏á", v1: "forsake", v2: "forsook", v3: "forsaken", decoy: "foresee" },
                { thai: "‡∏Ñ‡∏≤‡∏î‡∏Å‡∏≤‡∏£‡∏ì‡πå", v1: "foresee", v2: "foresaw", v3: "foreseen", decoy: "forget" },
                { thai: "‡∏ï‡πà‡∏≠‡∏™‡∏π‡πâ‡∏î‡∏¥‡πâ‡∏ô‡∏£‡∏ô", v1: "strive", v2: "strove", v3: "striven", decoy: "stride" },
                { thai: "‡πÄ‡∏≠‡∏≤‡∏ä‡∏ô‡∏∞", v1: "overcome", v2: "overcame", v3: "overcome", decoy: "overdo" },
                { thai: "‡πÄ‡∏´‡∏ß‡∏µ‡πà‡∏¢‡∏á/‡πÅ‡∏Å‡∏ß‡πà‡∏á", v1: "swing", v2: "swung", v3: "swung", decoy: "swim" },
                { thai: "‡∏™‡∏≤‡∏ö‡∏≤‡∏ô", v1: "swear", v2: "swore", v3: "sworn", decoy: "wear" },
                { thai: "‡∏ö‡∏µ‡∏ö/‡∏Ñ‡∏±‡πâ‡∏ô", v1: "wring", v2: "wrung", v3: "wrung", decoy: "wind" },
                { thai: "‡∏´‡∏ô‡∏µ", v1: "flee", v2: "fled", v3: "fled", decoy: "fly" },
            ]},
            { id: 10, title: "‡∏Å‡∏£‡∏¥‡∏¢‡∏≤‡∏¢‡∏≤‡∏Å 2", questions: [
                { thai: "‡∏Å‡∏±‡∏î", v1: "bite", v2: "bit", v3: "bitten", decoy: "bear" },
                { thai: "‡πÄ‡∏Å‡∏¥‡∏î", v1: "bear", v2: "bore", v3: "born/borne", decoy: "beat" },
                { thai: "‡∏ã‡πà‡∏≠‡∏ô/‡∏ã‡∏∏‡πà‡∏°", v1: "lie", v2: "lay", v3: "lain", decoy: "lay" },
                { thai: "‡∏ß‡∏≤‡∏á", v1: "lay", v2: "laid", v3: "laid", decoy: "lie" },
                { thai: "‡∏Ç‡∏≠‡∏£‡πâ‡∏≠‡∏á", v1: "plead", v2: "pleaded/pled", v3: "pleaded/pled", decoy: "pay" },
                { thai: "‡∏û‡∏¥‡∏™‡∏π‡∏à‡∏ô‡πå", v1: "prove", v2: "proved", v3: "proven/proved", decoy: "pay" },
                { thai: "‡πÄ‡∏¢‡πá‡∏ö", v1: "sew", v2: "sewed", v3: "sewn/sewed", decoy: "show" },
                { thai: "‡∏•‡∏∑‡πà‡∏ô", v1: "slide", v2: "slid", v3: "slid", decoy: "stick" },
                { thai: "‡∏ó‡∏≥‡∏•‡∏≤‡∏¢", v1: "undo", v2: "undid", v3: "undone", decoy: "understand" },
                { thai: "‡πÄ‡∏≠‡∏≤‡∏ä‡∏ô‡∏∞", v1: "overcome", v2: "overcame", v3: "overcome", decoy: "run" },
            ]},
             { id: 11, title: "‡∏Ñ‡∏≥‡∏ó‡∏µ‡πà‡∏°‡∏µ -ew/-own", questions: [
                { thai: "‡πÇ‡∏¢‡∏ô", v1: "throw", v2: "threw", v3: "thrown", decoy: "grow" },
                { thai: "‡∏õ‡∏•‡∏π‡∏Å/‡πÇ‡∏ï", v1: "grow", v2: "grew", v3: "grown", decoy: "know" },
                { thai: "‡∏ö‡∏¥‡∏ô", v1: "fly", v2: "flew", v3: "flown", decoy: "blow" },
                { thai: "‡πÄ‡∏õ‡πà‡∏≤", v1: "blow", v2: "blew", v3: "blown", decoy: "draw" },
                { thai: "‡∏ß‡∏≤‡∏î/‡∏î‡∏∂‡∏á", v1: "draw", v2: "drew", v3: "drawn", decoy: "drive" },
                { thai: "‡∏£‡∏π‡πâ", v1: "know", v2: "knew", v3: "known", decoy: "show" },
                { thai: "‡πÅ‡∏™‡∏î‡∏á", v1: "show", v2: "showed", v3: "shown/showed", decoy: "sow" },
                { thai: "‡∏´‡∏ß‡πà‡∏≤‡∏ô", v1: "sow", v2: "sowed", v3: "sown/sowed", decoy: "saw" },
                { thai: "‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏¢", v1: "saw", v2: "sawed", v3: "sawn/sawed", decoy: "sell" },
                { thai: "‡∏™‡∏ß‡∏°‡πÉ‡∏™‡πà", v1: "wear", v2: "wore", v3: "worn", decoy: "ring" },
            ]},
            { id: 12, title: "V2 = V3: -ght/-d/-t", questions: [
                { thai: "‡∏ô‡∏≥‡∏°‡∏≤", v1: "bring", v2: "brought", v3: "brought", decoy: "buy" },
                { thai: "‡∏ã‡∏∑‡πâ‡∏≠", v1: "buy", v2: "bought", v3: "bought", decoy: "catch" },
                { thai: "‡∏à‡∏±‡∏ö", v1: "catch", v2: "caught", v3: "caught", decoy: "fight" },
                { thai: "‡∏ï‡πà‡∏≠‡∏™‡∏π‡πâ", v1: "fight", v2: "fought", v3: "fought", decoy: "seek" },
                { thai: "‡πÅ‡∏™‡∏ß‡∏á‡∏´‡∏≤", v1: "seek", v2: "sought", v3: "sought", decoy: "teach" },
                { thai: "‡∏Ñ‡∏¥‡∏î", v1: "think", v2: "thought", v3: "thought", decoy: "send" },
                { thai: "‡πÉ‡∏´‡πâ‡∏¢‡∏∑‡∏°", v1: "lend", v2: "lent", v3: "lent", decoy: "lose" },
                { thai: "‡∏™‡∏£‡πâ‡∏≤‡∏á", v1: "build", v2: "built", v3: "built", decoy: "keep" },
                { thai: "‡πÄ‡∏ú‡∏≤", v1: "burn", v2: "burnt/burned", v3: "burnt/burned", decoy: "dream" },
                { thai: "‡πÇ‡∏Ñ‡πâ‡∏á‡∏Ñ‡∏≥‡∏ô‡∏±‡∏ö", v1: "bend", v2: "bent", v3: "bent", decoy: "send" },
            ]},
            { id: 13, title: "V1/V2/V3 ‡∏ï‡πà‡∏≤‡∏á‡∏Å‡∏±‡∏ô", questions: [
                { thai: "‡πÄ‡∏õ‡πá‡∏ô/‡∏≠‡∏¢‡∏π‡πà/‡∏Ñ‡∏∑‡∏≠", v1: "be", v2: "was/were", v3: "been", decoy: "bear" },
                { thai: "‡πÑ‡∏õ", v1: "go", v2: "went", v3: "gone", decoy: "do" },
                { thai: "‡∏Å‡∏¥‡∏ô", v1: "eat", v2: "ate", v3: "eaten", decoy: "fall" },
                { thai: "‡∏ó‡∏≥", v1: "do", v2: "did", v3: "done", decoy: "drive" },
                { thai: "‡πÄ‡∏´‡πá‡∏ô", v1: "see", v2: "saw", v3: "seen", decoy: "sing" },
                { thai: "‡πÉ‡∏´‡πâ", v1: "give", v2: "gave", v3: "given", decoy: "forgive" },
                { thai: "‡πÄ‡∏≠‡∏≤/‡∏û‡∏≤", v1: "take", v2: "took", v3: "taken", decoy: "shake" },
                { thai: "‡∏ó‡∏≥‡∏•‡∏≤‡∏¢/‡∏´‡∏±‡∏Å", v1: "break", v2: "broke", v3: "broken", decoy: "speak" },
                { thai: "‡πÄ‡∏•‡∏∑‡∏≠‡∏Å", v1: "choose", v2: "chose", v3: "chosen", decoy: "drive" },
                { thai: "‡∏Ç‡∏±‡∏ö", v1: "drive", v2: "drove", v3: "driven", decoy: "write" },
            ]},
            { id: 14, title: "V1 = V3 (‡∏Ñ‡∏≥‡∏ã‡πâ‡∏≥)", questions: [
                { thai: "‡∏°‡∏≤", v1: "come", v2: "came", v3: "come", decoy: "become" },
                { thai: "‡∏ß‡∏¥‡πà‡∏á", v1: "run", v2: "ran", v3: "run", decoy: "ring" },
                { thai: "‡πÄ‡∏õ‡πá‡∏ô/‡∏≠‡∏¢‡∏π‡πà/‡∏Ñ‡∏∑‡∏≠", v1: "become", v2: "became", v3: "become", decoy: "come" },
                { thai: "‡∏ó‡∏∏‡∏ö/‡∏ï‡∏µ", v1: "beat", v2: "beat", v3: "beaten/beat", decoy: "bite" },
                { thai: "‡∏ã‡πà‡∏≠‡∏ô", v1: "hide", v2: "hid", v3: "hidden", decoy: "ride" },
                { thai: "‡∏´‡πâ‡∏≤‡∏°", v1: "forbid", v2: "forbade", v3: "forbidden", decoy: "forget" },
                { thai: "‡∏Å‡∏±‡∏î", v1: "bite", v2: "bit", v3: "bitten", decoy: "hide" },
                { thai: "‡∏™‡πà‡∏≠‡∏á‡πÅ‡∏™‡∏á", v1: "shine", v2: "shone", v3: "shone", decoy: "show" },
                { thai: "‡∏ï‡∏∑‡πà‡∏ô", v1: "wake", v2: "woke", v3: "woken", decoy: "write" },
                { thai: "‡∏ä‡∏ô‡∏∞", v1: "win", v2: "won", v3: "won", decoy: "run" },
            ]},
            { id: 15, title: "‡∏Ñ‡∏≥‡∏Å‡∏£‡∏¥‡∏¢‡∏≤‡∏ó‡∏µ‡πà -ing", questions: [
                { thai: "‡∏ß‡πà‡∏≤‡∏¢‡∏ô‡πâ‡∏≥", v1: "swim", v2: "swam", v3: "swum", decoy: "begin" },
                { thai: "‡∏£‡πâ‡∏≠‡∏á‡πÄ‡∏û‡∏•‡∏á", v1: "sing", v2: "sang", v3: "sung", decoy: "ring" },
                { thai: "‡∏Å‡∏£‡∏∞‡∏î‡∏¥‡πà‡∏á", v1: "ring", v2: "rang", v3: "rung", decoy: "drink" },
                { thai: "‡∏î‡∏∑‡πà‡∏°", v1: "drink", v2: "drank", v3: "drunk", decoy: "sink" },
                { thai: "‡∏à‡∏°", v1: "sink", v2: "sank", v3: "sunk", decoy: "shrink" },
                { thai: "‡∏´‡∏î", v1: "shrink", v2: "shrank/shrunk", v3: "shrunk", decoy: "spring" },
                { thai: "‡∏Å‡∏£‡∏∞‡πÇ‡∏î‡∏î", v1: "spring", v2: "sprang/sprung", v3: "sprung", decoy: "stink" },
                { thai: "‡πÄ‡∏´‡∏°‡πá‡∏ô", v1: "stink", v2: "stank/stunk", v3: "stunk", decoy: "swing" },
                { thai: "‡πÅ‡∏Å‡∏ß‡πà‡∏á", v1: "swing", v2: "swung", v3: "swung", decoy: "sting" },
                { thai: "‡∏ï‡πà‡∏≠‡∏¢/‡πÅ‡∏ó‡∏á", v1: "sting", v2: "stung", v3: "stung", decoy: "sling" },
            ]},
            { id: 16, title: "‡∏Å‡∏£‡∏¥‡∏¢‡∏≤‡∏¢‡∏≤‡∏Å 3 (‡∏™‡∏±‡∏ö‡∏™‡∏ô)", questions: [
                { thai: "‡πÇ‡∏Å‡∏ô", v1: "shave", v2: "shaved", v3: "shaved/shaven", decoy: "show" },
                { thai: "‡πÅ‡∏™‡∏î‡∏á", v1: "show", v2: "showed", v3: "shown/showed", decoy: "sow" },
                { thai: "‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏¢", v1: "saw", v2: "sawed", v3: "sawn/sawed", decoy: "see" },
                { thai: "‡∏ñ‡πà‡∏°‡∏ô‡πâ‡∏≥‡∏•‡∏≤‡∏¢", v1: "spit", v2: "spat/spit", v3: "spat/spit", decoy: "sit" },
                { thai: "‡∏ú‡∏π‡∏Å‡∏°‡∏±‡∏î", v1: "bind", v2: "bound", v3: "bound", decoy: "find" },
                { thai: "‡∏Ñ‡∏∑‡∏ö‡∏Ñ‡∏•‡∏≤‡∏ô", v1: "creep", v2: "crept", v3: "crept", decoy: "keep" },
                { thai: "‡∏Ñ‡∏•‡∏∏‡∏Å‡∏Ñ‡∏•‡∏µ", v1: "deal", v2: "dealt", v3: "dealt", decoy: "dig" },
                { thai: "‡∏´‡∏ô‡∏µ", v1: "flee", v2: "fled", v3: "fled", decoy: "fly" },
                { thai: "‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö", v1: "get", v2: "got", v3: "got/gotten", decoy: "give" },
                { thai: "‡∏ï‡∏µ", v1: "strike", v2: "struck", v3: "struck/stricken", decoy: "stick" },
            ]},
            { id: 17, title: "‡∏Å‡∏£‡∏¥‡∏¢‡∏≤‡∏¢‡∏≤‡∏Å 4 (‡∏ã‡πâ‡∏≥ V2/V3)", questions: [
                { thai: "‡πÅ‡∏Ç‡∏ß‡∏ô (‡∏Ñ‡∏≠)", v1: "hang", v2: "hanged", v3: "hanged", decoy: "hung" },
                { thai: "‡∏¢‡∏∂‡∏î/‡∏ñ‡∏∑‡∏≠", v1: "hold", v2: "held", v3: "held", decoy: "hide" },
                { thai: "‡∏Ñ‡∏∏‡∏Å‡πÄ‡∏Ç‡πà‡∏≤", v1: "kneel", v2: "knelt/kneeled", v3: "knelt/kneeled", decoy: "know" },
                { thai: "‡∏ß‡∏≤‡∏á‡πÑ‡∏Ç‡πà/‡∏ã‡πà‡∏≠‡∏ô", v1: "lay", v2: "laid", v3: "laid", decoy: "lie" },
                { thai: "‡∏ô‡∏≥‡∏ó‡∏≤‡∏á", v1: "lead", v2: "led", v3: "led", decoy: "read" },
                { thai: "‡∏Å‡∏£‡∏∞‡πÇ‡∏î‡∏î", v1: "leap", v2: "leapt/leaped", v3: "leapt/leaped", decoy: "sleep" },
                { thai: "‡∏™‡πà‡∏≠‡∏á‡πÅ‡∏™‡∏á", v1: "light", v2: "lit/lighted", v3: "lit/lighted", decoy: "lose" },
                { thai: "‡∏´‡∏°‡∏≤‡∏¢‡∏ñ‡∏∂‡∏á", v1: "mean", v2: "meant", v3: "meant", decoy: "meet" },
                { thai: "‡∏Ç‡∏≠‡∏£‡πâ‡∏≠‡∏á", v1: "plead", v2: "pleaded/pled", v3: "pleaded/pled", decoy: "pay" },
                { thai: "‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô", v1: "write", v2: "wrote", v3: "written", decoy: "win" },
            ]},
            { id: 18, title: "‡∏Ñ‡∏≥‡∏Å‡∏£‡∏¥‡∏¢‡∏≤‡∏ó‡∏µ‡πà‡∏≠‡∏≠‡∏Å‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡∏Ñ‡∏•‡πâ‡∏≤‡∏¢", questions: [
                { thai: "‡∏ã‡πà‡∏≠‡∏ô", v1: "hide", v2: "hid", v3: "hidden", decoy: "hear" },
                { thai: "‡∏Ç‡∏µ‡πà", v1: "ride", v2: "rode", v3: "ridden", decoy: "ring" },
                { thai: "‡∏¢‡∏∑‡∏ô", v1: "stand", v2: "stood", v3: "stood", decoy: "steal" },
                { thai: "‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à", v1: "understand", v2: "understood", v3: "understood", decoy: "stand" },
                { thai: "‡∏Å‡∏¥‡∏ô", v1: "eat", v2: "ate", v3: "eaten", decoy: "sit" },
                { thai: "‡∏ï‡∏Å/‡∏•‡πâ‡∏°", v1: "fall", v2: "fell", v3: "fallen", decoy: "feel" },
                { thai: "‡∏´‡∏ô‡∏µ", v1: "flee", v2: "fled", v3: "fled", decoy: "fly" },
                { thai: "‡πÑ‡∏î‡πâ", v1: "get", v2: "got", v3: "got/gotten", decoy: "give" },
                { thai: "‡πÄ‡∏≠‡∏≤/‡∏û‡∏≤‡πÑ‡∏õ", v1: "take", v2: "took", v3: "taken", decoy: "shake" },
                { thai: "‡∏ß‡πà‡∏≤‡∏¢‡∏ô‡πâ‡∏≥", v1: "swim", v2: "swam", v3: "swum", decoy: "swing" },
            ]},
            { id: 19, title: "‡∏Ñ‡∏≥‡∏Å‡∏£‡∏¥‡∏¢‡∏≤‡∏ó‡∏µ‡πà‡∏•‡∏á‡∏ó‡πâ‡∏≤‡∏¢‡∏î‡πâ‡∏ß‡∏¢ -d", questions: [
                { thai: "‡∏™‡∏£‡πâ‡∏≤‡∏á", v1: "build", v2: "built", v3: "built", decoy: "buy" },
                { thai: "‡∏ô‡∏≥", v1: "lead", v2: "led", v3: "led", decoy: "read" },
                { thai: "‡πÉ‡∏´‡πâ‡∏¢‡∏∑‡∏°", v1: "lend", v2: "lent", v3: "lent", decoy: "send" },
                { thai: "‡∏ó‡∏≥‡πÉ‡∏´‡πâ", v1: "make", v2: "made", v3: "made", decoy: "meet" },
                { thai: "‡∏à‡πà‡∏≤‡∏¢", v1: "pay", v2: "paid", v3: "paid", decoy: "say" },
                { thai: "‡∏û‡∏π‡∏î/‡∏Å‡∏•‡πà‡∏≤‡∏ß", v1: "say", v2: "said", v3: "said", decoy: "see" },
                { thai: "‡∏Ç‡∏≤‡∏¢", v1: "sell", v2: "sold", v3: "sold", decoy: "tell" },
                { thai: "‡∏ö‡∏≠‡∏Å", v1: "tell", v2: "told", v3: "told", decoy: "think" },
                { thai: "‡∏Ç‡∏∏‡∏î", v1: "dig", v2: "dug", v3: "dug", decoy: "drink" },
                { thai: "‡∏ù‡∏±‡∏ô", v1: "dream", v2: "dreamed/dreamt", v3: "dreamed/dreamt", decoy: "feel" },
            ]},
            { id: 20, title: "‡∏Ñ‡∏≥‡∏Å‡∏£‡∏¥‡∏¢‡∏≤‡∏ó‡∏µ‡πà‡∏≠‡∏≠‡∏Å‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡πÅ‡∏õ‡∏•‡∏Å", questions: [
                { thai: "‡∏≠‡πà‡∏≤‡∏ô", v1: "read", v2: "read", v3: "read", decoy: "ride" },
                { thai: "‡∏Å‡πâ‡∏°/‡πÇ‡∏Ñ‡πâ‡∏á", v1: "bend", v2: "bent", v3: "bent", decoy: "bind" },
                { thai: "‡∏ú‡∏π‡∏Å", v1: "bind", v2: "bound", v3: "bound", decoy: "bend" },
                { thai: "‡πÑ‡∏î‡πâ‡∏¢‡∏¥‡∏ô", v1: "hear", v2: "heard", v3: "heard", decoy: "hold" },
                { thai: "‡∏ã‡πà‡∏≠‡∏ô", v1: "hide", v2: "hid", v3: "hidden", decoy: "hit" },
                { thai: "‡∏à‡∏∏‡∏î‡πÑ‡∏ü", v1: "light", v2: "lit/lighted", v3: "lit/lighted", decoy: "lose" },
                { thai: "‡πÇ‡∏¢‡∏ô", v1: "throw", v2: "threw", v3: "thrown", decoy: "fly" },
                { thai: "‡∏Ç‡πÇ‡∏°‡∏¢", v1: "steal", v2: "stole", v3: "stolen", decoy: "speak" },
                { thai: "‡∏ß‡πà‡∏≤‡∏¢‡∏ô‡πâ‡∏≥", v1: "swim", v2: "swam", v3: "swum", decoy: "sink" },
                { thai: "‡πÄ‡∏Å‡∏¥‡∏î", v1: "bear", v2: "bore", v3: "born/borne", decoy: "bite" },
            ]},
        ].filter(set => set.questions.length > 0); 


        // --- CONSTANTS ---
        const NORMAL_TIMER_MS = 5000;
        const AUTO_PLAY_TIMER_MS = 3000; 
        const POST_THAI_SPEECH_DELAY_MS = 500; 
        const SLASH_SPEECH_DELAY_MS = 250; 

        // --- ELEMENTS ---
        const mainContainer = document.getElementById('main-container');
        const levelSelectScreen = document.getElementById('level-select-screen');
        const modeSelectScreen = document.getElementById('mode-select-screen');
        const gameScreen = document.getElementById('game-screen');
        const levelGridEl = document.getElementById('level-grid');
        const modeLevelTitleEl = document.getElementById('mode-level-title');

        const levelTitleEl = document.getElementById('level-title');
        const qCountEl = document.getElementById('q-count');
        const scoreEl = document.getElementById('score');
        const thaiPromptEl = document.getElementById('thai-prompt');
        const timerBarEl = document.getElementById('timer-bar');
        const choiceA = document.getElementById('choice-A');
        const choiceB = document.getElementById('choice-B');
        const nextBtn = document.getElementById('next-btn');
        const autoToggleBtn = document.getElementById('auto-toggle-btn');
        const gameFooterEl = document.getElementById('game-footer');
        const stepIndicatorEl = document.getElementById('step-indicator');
        const choiceButtons = [choiceA, choiceB];
        const startNormalBtn = document.getElementById('start-normal-btn');
        const startAutoBtn = document.getElementById('start-auto-btn');
        const backToLevelBtn = document.getElementById('back-to-level-btn');

        // --- GAME STATE ---
        let selectedLevelId = null; 
        let currentLevelData = null;
        let currentQuizIndex = 0;
        let score = 0;
        let timerTimeout = null;
        let autoPlayTimeout = null;
        let isAnswered = false; 
        let isAutoPlay = false; 
        let isSpeaking = false;
        let voices = [];
        let audioContext;
        let currentQuestion = null; 
        let currentAnswerStep = 'V2'; 

        // --- CORE FUNCTIONS (AUDIO TONE) ---
        function initAudioContext() {
            if (!audioContext) {
                audioContext = new (window.AudioContext || window.webkitAudioContext)();
            }
        }
        
        function createTone(frequency, duration, type, volume = 0.5, startFreq = null) {
            initAudioContext();
            if (!audioContext || audioContext.state === 'suspended') return;
            
            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();

            oscillator.connect(gainNode);
            gainNode.connect(audioContext.destination);

            if (startFreq) {
                oscillator.frequency.setValueAtTime(startFreq, audioContext.currentTime);
                oscillator.frequency.linearRampToValueAtTime(frequency, audioContext.currentTime + duration * 0.5);
            } else {
                 oscillator.frequency.setValueAtTime(frequency, audioContext.currentTime);
            }
            
            oscillator.type = type; 

            gainNode.gain.setValueAtTime(volume, audioContext.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.00001, audioContext.currentTime + duration);

            oscillator.start();
            oscillator.stop(audioContext.currentTime + duration);
        }

        function playPing() {
            createTone(880, 0.15, 'sine', 0.8, 660); 
        }

        function playFailTone() {
            createTone(150, 0.4, 'triangle', 0.7, 200); 
        }

        // --- CORE FUNCTIONS (SPEECH SYNTHESIS) ---
        function setupSpeech() {
            if ('speechSynthesis' in window) {
                window.speechSynthesis.onvoiceschanged = () => {
                    voices = window.speechSynthesis.getVoices();
                };
            }
        }
        
        function getVoice(lang) {
            if (lang === 'en-US') {
                return voices.find(v => v.lang.startsWith('en-US') && (v.name.includes('Samantha') || v.name.includes('Google US English'))) || voices.find(v => v.lang.startsWith('en-US'));
            } else if (lang === 'th-TH') {
                return voices.find(v => v.lang.startsWith('th-TH')) || null;
            }
            return null;
        }

        /**
         * Speak a single block of text (used for Thai or single English words)
         */
        function speakText(text, lang, onEndCallback = null) {
            if (!'speechSynthesis' in window) {
                if(onEndCallback) onEndCallback();
                return;
            }
            
            isSpeaking = true;
            const utterance = new SpeechSynthesisUtterance(text);
            utterance.lang = lang;
            utterance.rate = lang === 'th-TH' ? 0.9 : 0.8; 
            utterance.volume = 1;

            const targetVoice = getVoice(lang);
            if (targetVoice) {
                utterance.voice = targetVoice;
            }

            utterance.onend = () => {
                isSpeaking = false;
                if (onEndCallback) onEndCallback();
            };
            utterance.onerror = () => {
                isSpeaking = false;
                if (onEndCallback) onEndCallback();
            };
            window.speechSynthesis.speak(utterance);
        }

        /**
         * Speak English words with a slash (/) with a delay between them.
         */
        function speakWithSlash(text, lang, partDelay, onEnd = null) {
            if(text.indexOf('/') === -1) {
                speakText(text, lang, onEnd);
                return;
            }
            
            window.speechSynthesis.cancel();
            const parts = text.split('/');
            let partIndex = 0;

            function speakNextPart() {
                if (partIndex >= parts.length) {
                    if (onEnd) onEnd();
                    return;
                }
                
                const part = parts[partIndex].trim();
                
                isSpeaking = true;
                const utterance = new SpeechSynthesisUtterance(part);
                
                utterance.lang = lang;
                utterance.rate = 0.8; 
                utterance.volume = 1;
                const targetVoice = getVoice(lang);
                if (targetVoice) {
                    utterance.voice = targetVoice;
                }

                utterance.onend = () => {
                    isSpeaking = false;
                    partIndex++;
                    if (partIndex < parts.length) {
                        setTimeout(speakNextPart, partDelay); 
                    } else if (onEnd) {
                        onEnd();
                    }
                };
                utterance.onerror = () => {
                    isSpeaking = false;
                    if (onEnd) onEnd(); 
                };
                window.speechSynthesis.speak(utterance);
            }
            
            speakNextPart();
        }


        /**
         * Handle the sequential speech (V1 -> V2 -> V3 -> Thai -> Pause) for final reveal.
         */
        function handleFinalRevealSpeech(v1, v2, v3, thaiMeaning, finalAction) {
            window.speechSynthesis.cancel();

            // 1. Speak V1 (with slash pause if needed)
            speakWithSlash(v1, 'en-US', SLASH_SPEECH_DELAY_MS, () => {
                // 2. Speak V2 (with slash pause if needed)
                speakWithSlash(v2, 'en-US', SLASH_SPEECH_DELAY_MS, () => {
                     // 3. Speak V3 (with slash pause if needed)
                    speakWithSlash(v3, 'en-US', SLASH_SPEECH_DELAY_MS, () => {
                        // 4. Speak Thai meaning
                        speakText(thaiMeaning, 'th-TH', () => {
                            // 5. 0.5 second pause before final action (advancing the game)
                            if (finalAction) {
                                autoPlayTimeout = setTimeout(finalAction, POST_THAI_SPEECH_DELAY_MS); 
                            }
                        });
                    });
                });
            });
        }


        // --- UTILITIES ---
        /**
         * Get a V3 form from a random verb for use as a decoy in the V3 step
         */
        function getV3Decoy(correctV3, questions) {
            let decoyV3 = correctV3;
            for (let i = 0; i < 5; i++) {
                const randomQ = questions[Math.floor(Math.random() * questions.length)];
                const potentialDecoy = randomQ.v3;
                
                const correctNorm = correctV3.split('/')[0].trim().toLowerCase();
                const potentialNorm = potentialDecoy.split('/')[0].trim().toLowerCase();
                
                if (potentialNorm !== correctNorm) {
                    return potentialDecoy;
                }
            }
            return questions[currentQuizIndex].v2; 
        }

        // --- UI & SCREEN MANAGEMENT ---

        function showScreen(id) {
            document.querySelectorAll('.screen').forEach(screen => {
                screen.classList.remove('active');
            });
            document.getElementById(id).classList.add('active');
            
            clearTimeout(timerTimeout);
            clearTimeout(autoPlayTimeout);
            window.speechSynthesis.cancel();
        }

        function createLevelButtons() {
            levelGridEl.innerHTML = '';
            allQuizData.forEach(data => {
                const btn = document.createElement('button');
                btn.className = 'level-btn';
                
                if (data.id >= 11) {
                    btn.classList.add('level-btn-11-20');
                }
                
                btn.textContent = `‡∏ä‡∏∏‡∏î ${data.id}`;
                
                const titleSpan = document.createElement('span');
                titleSpan.className = 'level-btn-title';
                titleSpan.textContent = data.title;
                
                btn.appendChild(titleSpan);
                btn.setAttribute('data-level', data.id);
                
                btn.addEventListener('click', () => {
                    initAudioContext(); 
                    if (audioContext && audioContext.state === 'suspended') {
                         audioContext.resume();
                    }
                    selectedLevelId = data.id;
                    setupModeSelection(data.id);
                });
                levelGridEl.appendChild(btn);
            });
        }

        function setupModeSelection(levelId) {
            currentLevelData = allQuizData.find(data => data.id === levelId);
            modeLevelTitleEl.textContent = `‡∏ä‡∏∏‡∏î ${levelId}: ${currentLevelData.title}`;
            
            if (levelId >= 11) {
                mainContainer.classList.add('hard-theme');
            } else {
                mainContainer.classList.remove('hard-theme');
            }
            
            showScreen('mode-select-screen');
        }
        
        function updateStatusBar() {
            levelTitleEl.textContent = `${currentLevelData.title} (‡∏ä‡∏∏‡∏î ${currentLevelData.id})`;
            qCountEl.textContent = `‡∏Ç‡πâ‡∏≠: ${currentQuizIndex}/${currentLevelData.questions.length}`;
            scoreEl.textContent = `‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô: ${score}`;
        }
        
        function updateAutoPlayControls() {
            if (isAutoPlay) {
                gameFooterEl.classList.add('auto-mode');
                autoToggleBtn.style.display = 'flex'; 
                autoToggleBtn.classList.add('auto-active');
                autoToggleBtn.innerHTML = '‚è∏Ô∏è ‡∏´‡∏¢‡∏∏‡∏î‡πÄ‡∏•‡πà‡∏ô<span>(Auto)</span>'; 
                nextBtn.textContent = '‚è≠Ô∏è ‡∏Ç‡πâ‡∏≤‡∏°/‡∏à‡∏ö‡πÄ‡∏Å‡∏°';
            } else {
                gameFooterEl.classList.remove('auto-mode');
                autoToggleBtn.style.display = 'flex'; 
                autoToggleBtn.classList.remove('auto-active');
                autoToggleBtn.innerHTML = '‚ñ∂Ô∏è ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏•‡πà‡∏ô<span>(Auto)</span>'; 
                
                nextBtn.textContent = (currentQuizIndex >= currentLevelData.questions.length && isAnswered) ? '‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å (‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ä‡∏∏‡∏î‡∏Ñ‡∏≥‡∏®‡∏±‡∏û‡∏ó‡πå)' : '‡∏Ç‡πâ‡∏≠‡∏ñ‡∏±‡∏î‡πÑ‡∏õ ‚è≠Ô∏è';
            }
        }


        // --- GAME LOGIC ---
        function startGame(levelId, autoMode) {
            currentLevelData = allQuizData.find(data => data.id === levelId); 
            isAutoPlay = autoMode;
            currentQuizIndex = 0;
            score = 0;
            currentAnswerStep = 'V2'; 
            
            if (levelId >= 11) {
                mainContainer.classList.add('hard-theme');
            } else {
                mainContainer.classList.remove('hard-theme');
            }
            
            showScreen('game-screen');
            updateAutoPlayControls();
            nextQuestion();
        }

        function startAutoPlay() {
            if (isAutoPlay) return;
            isAutoPlay = true;
            updateAutoPlayControls();
            
            if (!isAnswered && currentQuizIndex < currentLevelData.questions.length) {
                window.speechSynthesis.cancel(); 
                startTimer(); 
            }
        }

        function stopAutoPlay() {
            if (!isAutoPlay) return;
            isAutoPlay = false;
            clearTimeout(timerTimeout);
            clearTimeout(autoPlayTimeout);
            window.speechSynthesis.cancel();
            
            if (!isAnswered && currentQuizIndex < currentLevelData.questions.length) {
                 choiceButtons.forEach(btn => btn.disabled = false);
                 
                 thaiPromptEl.textContent = `‚úÖ ‡∏´‡∏¢‡∏∏‡∏î‡πÄ‡∏•‡πà‡∏ô! (‡∏Å‡∏•‡∏±‡∏ö‡∏™‡∏π‡πà‡πÇ‡∏´‡∏°‡∏î‡∏õ‡∏Å‡∏ï‡∏¥)`;
                 thaiPromptEl.style.fontSize = '1.8rem';
                 thaiPromptEl.style.color = 'var(--color-correct)';
                 
                 setTimeout(() => {
                    if (!isAnswered) {
                         setupQuestion(currentQuestion); 
                    }
                 }, 500); 
            }
            
            updateAutoPlayControls();
        }

        function nextQuestion() {
            clearTimeout(timerTimeout);
            clearTimeout(autoPlayTimeout);
            window.speechSynthesis.cancel();
            
            if (currentQuizIndex >= currentLevelData.questions.length) {
                endGame();
                return;
            }
            
            currentQuestion = currentLevelData.questions[currentQuizIndex];
            currentAnswerStep = 'V2'; 
            isAnswered = false;
            nextBtn.disabled = true;
            updateAutoPlayControls(); 

            // Reset UI
            thaiPromptEl.style.fontSize = '2.5rem';
            thaiPromptEl.style.color = 'var(--color-primary)';
            
            // Reset buttons to default appearance
            choiceButtons.forEach(btn => {
                btn.className = 'choice-button'; // Reset all classes
                btn.disabled = isAutoPlay; 
            });
            
            updateStatusBar();
            setupQuestion(currentQuestion);
        }

        function setupQuestion(q) {
            
            // 1. Set V1 prompt
            const promptText = q.v1; 
            thaiPromptEl.textContent = promptText;
            
            // 2. Set Choices (V2 or V3)
            let correctAnswer;
            let decoyAnswer;
            let targetForm;
            let currentPrompt;

            if (currentAnswerStep === 'V2') {
                targetForm = 'V2';
                currentPrompt = q.v1;
                correctAnswer = q.v2;
                decoyAnswer = q.v3.split('/')[0].trim().toLowerCase() !== q.v2.split('/')[0].trim().toLowerCase() ? q.v3 : q.decoy; 
                stepIndicatorEl.textContent = `‡πÇ‡∏à‡∏ó‡∏¢‡πå V1: ${currentPrompt} | ‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö ${targetForm}`;
            } else if (currentAnswerStep === 'V3') {
                targetForm = 'V3';
                currentPrompt = q.v2; // Prompt is now V2
                correctAnswer = q.v3;
                decoyAnswer = getV3Decoy(correctAnswer, currentLevelData.questions); 
                stepIndicatorEl.textContent = `‡πÇ‡∏à‡∏ó‡∏¢‡πå V2: ${currentPrompt} | ‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö ${targetForm}`;
                thaiPromptEl.textContent = currentPrompt; // Set prompt to V2
            }

            // Speak the V1/V2 prompt immediately (English)
            if (currentAnswerStep === 'V2') {
                window.speechSynthesis.cancel();
                speakWithSlash(promptText, 'en-US', SLASH_SPEECH_DELAY_MS); 
            }

            // Prepare choices
            const choices = [correctAnswer, decoyAnswer];
            choices.sort(() => 0.5 - Math.random());

            choiceA.textContent = choices[0];
            choiceA.setAttribute('data-correct', choices[0] === correctAnswer);
            choiceA.title = targetForm;
            
            choiceB.textContent = choices[1];
            choiceB.setAttribute('data-correct', choices[1] === correctAnswer);
            choiceB.title = targetForm;
            
            // Reset button styles to default for current step
            choiceButtons.forEach(btn => {
                btn.className = 'choice-button'; // Reset classes
                btn.disabled = isAutoPlay; 
            });

            startTimer();
        }

        function startTimer() {
            const durationMs = isAutoPlay ? AUTO_PLAY_TIMER_MS : NORMAL_TIMER_MS;
            const durationSec = durationMs / 1000;

            timerBarEl.style.transition = 'none';
            timerBarEl.style.width = '100%';
            
            void timerBarEl.offsetWidth; 

            setTimeout(() => {
                timerBarEl.style.transition = `width ${durationSec}s linear`;
                timerBarEl.style.width = '0%';
            }, 50);

            timerTimeout = setTimeout(() => {
                if (!isAnswered) {
                    checkAnswer(null, isAutoPlay); 
                }
            }, durationMs);
        }

        function checkAnswer(selectedBtn, isAuto) {
            if (isAnswered && !isAuto) return;
            
            clearTimeout(timerTimeout);
            
            timerBarEl.style.transition = 'none';
            timerBarEl.style.width = '0%'; 

            const isCorrect = isAuto ? true : (selectedBtn && selectedBtn.getAttribute('data-correct') === 'true'); 
            const currentQ = currentQuestion;

            // 1. Logic for V2 Step
            if (currentAnswerStep === 'V2') {
                if (isCorrect) {
                    playPing();
                    isAnswered = false; // V2 step is finished, but not the whole question
                    
                    // Highlight the correct V2 button, dim the other
                    choiceButtons.forEach(btn => {
                        btn.disabled = true; // Disable until V3 is ready
                        if (btn.textContent.includes(currentQ.v2.split('/')[0].trim())) { 
                             btn.classList.add('correct'); // Highlight and enlarge
                             btn.classList.remove('dimmed');
                        } else {
                             btn.classList.add('dimmed'); // Dim the incorrect V2 option
                             btn.classList.remove('correct');
                        }
                    });
                    
                    thaiPromptEl.textContent = `‚úÖ ‡∏ñ‡∏π‡∏Å V2! ‡∏ï‡∏≠‡∏ô‡∏ô‡∏µ‡πâ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å V3 ‡∏Ç‡∏≠‡∏á: ${currentQ.v2}`;
                    thaiPromptEl.style.fontSize = '1.5rem';
                    thaiPromptEl.style.color = 'var(--color-correct)';

                    currentAnswerStep = 'V3';
                    autoPlayTimeout = setTimeout(() => {
                         setupQuestion(currentQ); // Start V3 step
                    }, isAutoPlay ? 1000 : 1500); // Shorter delay for auto, longer for normal
                    
                    return; // Exit as the question is not fully answered
                } else {
                    // V2 incorrect - treat as final incorrect answer for the whole question
                    playFailTone();
                    isAnswered = true; 
                    currentAnswerStep = 'REVEAL'; // Go directly to full reveal
                    choiceButtons.forEach(btn => btn.disabled = true);
                    nextBtn.disabled = false;
                    
                    if (selectedBtn) selectedBtn.classList.add('wrong');
                    
                    revealAnswer(currentQ, selectedBtn, isCorrect, isAuto, () => {
                        currentQuizIndex++;
                        nextQuestion();
                    });
                    return; 
                }
            }
            
            // 2. Logic for V3 Step
            if (currentAnswerStep === 'V3') {
                if (isCorrect) {
                    score++;
                    playPing();
                } else {
                    playFailTone();
                }

                isAnswered = true; 
                currentAnswerStep = 'REVEAL';
                choiceButtons.forEach(btn => btn.disabled = true);
                nextBtn.disabled = false;

                // Highlight buttons based on final V3 answer
                choiceButtons.forEach(btn => {
                    if (btn.textContent.includes(currentQ.v3.split('/')[0].trim())) { 
                        btn.classList.add('correct');
                        btn.classList.remove('dimmed');
                    } else if (selectedBtn === btn && !isCorrect) {
                        btn.classList.add('wrong');
                        btn.classList.remove('dimmed');
                    } else {
                        btn.classList.add('dimmed');
                        btn.classList.remove('correct', 'wrong');
                    }
                });

                revealAnswer(currentQ, selectedBtn, isCorrect, isAuto, () => {
                    currentQuizIndex++;
                    nextQuestion();
                });
                return;
            }
        }

        // Modified to display all three forms and handle sequential speech
        function revealAnswer(q, selectedBtn, isCorrect, isAuto, onSpeechEnd = null) {
            const statusPrefix = isCorrect ? '‚úÖ ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á: ' : (selectedBtn ? '‚ùå ‡∏ú‡∏¥‡∏î: ' : '‚è∞ ‡∏´‡∏°‡∏î‡πÄ‡∏ß‡∏•‡∏≤: ');
            const fullRevealText = `${q.thai}`;
            
            thaiPromptEl.textContent = statusPrefix + fullRevealText;
            thaiPromptEl.style.fontSize = '1.5rem';
            thaiPromptEl.style.color = isCorrect ? 'var(--color-correct)' : 'var(--color-wrong)';
            
            stepIndicatorEl.textContent = `V1: ${q.v1} | V2: ${q.v2} | V3: ${q.v3}`;

            // Reset all choice buttons to default, then highlight correct ones
            choiceButtons.forEach(btn => {
                btn.className = 'choice-button'; // Reset all classes
                btn.disabled = true; // Keep disabled after reveal
            });
            
            // Highlight V2 and V3 as correct
            choiceButtons.forEach(btn => {
                const buttonText = btn.textContent.split('/')[0].trim().toLowerCase();
                const v2Norm = q.v2.split('/')[0].trim().toLowerCase();
                const v3Norm = q.v3.split('/')[0].trim().toLowerCase();

                if (buttonText === v2Norm || buttonText === v3Norm) {
                    btn.classList.add('correct');
                    btn.classList.remove('dimmed');
                } else {
                    btn.classList.add('dimmed');
                }
            });

            handleFinalRevealSpeech(q.v1, q.v2, q.v3, q.thai, onSpeechEnd);
            
            updateStatusBar();
        }


        function endGame() {
            isAutoPlay = false;
            clearTimeout(autoPlayTimeout);
            
            levelTitleEl.textContent = `‡∏à‡∏ö‡∏ä‡∏∏‡∏î‡∏Ñ‡∏≥‡∏®‡∏±‡∏û‡∏ó‡πå ${currentLevelData.id}!`;
            qCountEl.textContent = '';
            
            thaiPromptEl.textContent = `‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏≥‡πÑ‡∏î‡πâ ${score}/${currentLevelData.questions.length} ‡∏Ç‡πâ‡∏≠`;
            thaiPromptEl.style.fontSize = '2.5rem';
            thaiPromptEl.style.color = score >= (currentLevelData.questions.length * 0.8) ? 'var(--color-correct)' : 'var(--color-wrong)';
            stepIndicatorEl.textContent = '‡∏ú‡∏•‡∏™‡∏£‡∏∏‡∏õ';

            choiceButtons.forEach(btn => btn.style.display = 'none');
            
            nextBtn.textContent = '‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å (‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ä‡∏∏‡∏î‡∏Ñ‡∏≥‡∏®‡∏±‡∏û‡∏ó‡πå)';
            nextBtn.disabled = false;
            
            updateAutoPlayControls();
        }

        // --- EVENT LISTENERS ---
        function handleChoiceClick(e) {
            if (audioContext && audioContext.state === 'suspended') {
                 audioContext.resume();
            }
            if (!isAnswered) { 
                checkAnswer(e.target, false);
            }
        }

        // Mode Selection Handlers
        startNormalBtn.addEventListener('click', () => {
            startGame(selectedLevelId, false);
        });
        startAutoBtn.addEventListener('click', () => {
            startGame(selectedLevelId, true);
        });
        backToLevelBtn.addEventListener('click', () => {
             mainContainer.classList.remove('hard-theme');
             showScreen('level-select-screen');
        });

        choiceA.addEventListener('click', handleChoiceClick);
        choiceB.addEventListener('click', handleChoiceClick);

        nextBtn.addEventListener('click', () => {
            window.speechSynthesis.cancel();
            clearTimeout(autoPlayTimeout); 
            
            if (currentQuizIndex >= currentLevelData.questions.length) {
                // End game / Back to home
                choiceButtons.forEach(btn => btn.style.display = 'block');
                mainContainer.classList.remove('hard-theme');
                isAutoPlay = false;
                showScreen('level-select-screen');
            } else {
                // Normal mode advance / Auto mode skip
                currentQuizIndex++;
                currentAnswerStep = 'V2';
                nextQuestion();
            }
        });
        
        // Auto Play Toggle Button Handler
        autoToggleBtn.addEventListener('click', () => {
            if (isAutoPlay) {
                stopAutoPlay();
            } else {
                startAutoPlay();
            }
        });


        // --- INITIAL SETUP ---
        document.addEventListener('DOMContentLoaded', () => {
            setupSpeech();
            createLevelButtons();
            showScreen('level-select-screen');
        });
    </script>
</body>
</html>
